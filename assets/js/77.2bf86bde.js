(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{576:function(s,t,a){"use strict";a.r(t);var n=a(33),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"mongodb安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb安装"}},[s._v("#")]),s._v(" MongoDB安装")]),s._v(" "),a("h3",{attrs:{id:"参考文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[s._v("#")]),s._v(" 参考文档")]),s._v(" "),a("p",[s._v("官网下载："),a("a",{attrs:{href:"https://www.mongodb.com/try/download/community",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.mongodb.com/try/download/community"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("官网文档："),a("a",{attrs:{href:"https://docs.mongodb.com/v3.6/administration/install-community/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.mongodb.com/v3.6/administration/install-community/"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("菜鸟教程："),a("a",{attrs:{href:"https://www.runoob.com/mongodb/mongodb-window-install.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.runoob.com/mongodb/mongodb-window-install.html"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"以docker为例安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#以docker为例安装"}},[s._v("#")]),s._v(" 以Docker为例安装")]),s._v(" "),a("p",[s._v("1、拉取镜像")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mongo:latest\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("注意：有的服务器不支持新版本，会导致Docker启动失败，具体原因看报错内容")]),s._v(" "),a("p",[s._v("可选择其他版本（我使用的服务器5.0及以上版本都不可使）")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mongo:4.4.8\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("2、创建和启动容器")]),s._v(" "),a("p",[s._v("以 4.4.8 版本为例 "),a("Badge",{attrs:{text:"建议加上密码，原因看下方"}})],1),s._v(" "),a("code-group",[a("code-block",{attrs:{title:"不带密码启动",active:""}},[a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d --restart"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always  --name mymongo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27017")]),s._v(":27017 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /data/docker/mongodb:/data/db "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  mongo:4.4.8\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("code-block",{attrs:{title:"带密码启动"}},[a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d --restart"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always --name mymongo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27017")]),s._v(":27017  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -e "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MONGO_INITDB_ROOT_USERNAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mymongoadmin "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -e "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MONGO_INITDB_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root123456 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /data/docker/mongodb:/data/db "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  mongo:4.4.8\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])])],1),s._v(" "),a("p",[s._v("使用账户密码启动的，需要给数据库创建用户权限：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("db.createUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        user:"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),s._v(",\n        pwd:"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root123456"')]),s._v(",\n        roles:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("role:"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dbOwner"')]),s._v(",db:"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yygh_hosp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("之后sping中MongoDB地址改成：")]),s._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("spring.data.mongodb.uri")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("mongodb://admin:root123456@IP:端口/yygh_hosp")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("角色权限说明(role)：")]),s._v(" "),a("p",[s._v("Built-In Roles（内置角色）：")]),s._v(" "),a("ol",[a("li",[s._v("数据库用户角色：read、readWrite;")]),s._v(" "),a("li",[s._v("数据库管理角色：dbAdmin、dbOwner、userAdmin；")]),s._v(" "),a("li",[s._v("集群管理角色：clusterAdmin、clusterManager、clusterMonitor、hostManager；")]),s._v(" "),a("li",[s._v("备份恢复角色：backup、restore；")]),s._v(" "),a("li",[s._v("所有数据库角色：readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase")]),s._v(" "),a("li",[s._v("超级用户角色：root")])]),s._v(" "),a("blockquote",[a("p",[s._v("这里还有几个角色间接或直接提供了系统超级用户的访问")]),s._v(" "),a("p",[s._v("（dbOwner 、userAdmin、userAdminAnyDatabase）")])]),s._v(" "),a("Badge",{attrs:{text:"带密码原因：",type:"error",vertical:"middle"}}),s._v(" "),a("p",[s._v("之前学习 "),a("a",{attrs:{href:"https://www.bilibili.com/video/BV1V5411K7rT?p=163",target:"_blank",rel:"noopener noreferrer"}},[s._v("尚硅谷-尚医通项目"),a("OutboundLink")],1),s._v(" 用到了MongoDB")]),s._v(" "),a("p",[s._v("我安装到了服务器上，没换端口地址且没设密码")]),s._v(" "),a("p",[s._v("后来某一天，数据库让淦了，所有数据都没了，只剩下个勒索数据：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/oddfar/static/img/MongoDB/image-20210911115120977.png",alt:"image-20210911115120977"}})]),s._v(" "),a("p",[s._v("翻译后：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/oddfar/static/img/MongoDB/image-20210911115316142.png",alt:"image-20210911115316142"}})]),s._v(" "),a("p",[s._v("还好只是学习的测试数据，不然就完犊子了")]),s._v(" "),a("p",[s._v("百度了一下参考了 "),a("a",{attrs:{href:"https://blog.csdn.net/u013513053/article/details/105785980/",target:"_blank",rel:"noopener noreferrer"}},[s._v("mongoDB 数据莫名其妙的没了"),a("OutboundLink")],1),s._v(" 这篇文章，才知道数据库是被黑了")]),s._v(" "),a("h2",{attrs:{id:"连接和建库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#连接和建库"}},[s._v("#")]),s._v(" 连接和建库")]),s._v(" "),a("p",[s._v("默认保留的数据库")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("admin")]),s._v(": 从权限角度考虑, 这是 "),a("code",[s._v("root")]),s._v(" 数据库, 如果将一个用户添加到这个数据库, 这个用户自动继承所有数据库的权限, 一些特定的服务器端命令也只能从这个数据库运行, 比如列出所有的数据库或者关闭服务器")]),s._v(" "),a("li",[a("strong",[s._v("local")]),s._v(": 数据永远不会被复制, 可以用来存储限于本地的单台服务器的集合 (部署集群, 分片等)")]),s._v(" "),a("li",[a("strong",[s._v("config")]),s._v(": Mongo 用于分片设置时, "),a("code",[s._v("config")]),s._v(" 数据库在内部使用, 用来保存分片的相关信息")])]),s._v(" "),a("p",[s._v("进入容器")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it mymongo /bin/bash \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("连接mongo")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("mongo -u mymongoadmin -p root123456\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("基本操作：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看所有数据库")]),s._v("\nshow dbs\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用数据库，没有这个数据则自动创建")]),s._v("\nuse testdb\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("当 "),a("code",[s._v("use testdb")]),s._v(" 的时候. "),a("code",[s._v("testdb")]),s._v(" 其实存放在内存之中,")]),s._v(" "),a("p",[s._v("当 "),a("code",[s._v("testdb")]),s._v(" 中存在一个 document 之后, mongo 才会将这个数据库持久化到硬盘之中.")]),s._v(" "),a("h2",{attrs:{id:"文档基本-crud"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文档基本-crud"}},[s._v("#")]),s._v(" 文档基本 CRUD")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("官方文档")]),s._v(" "),a("p",[s._v("https://docs.mongodb.com/manual/crud/")])]),s._v(" "),a("h3",{attrs:{id:"插入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#插入"}},[s._v("#")]),s._v(" 插入")]),s._v(" "),a("ul",[a("li",[s._v("图例")])]),s._v(" "),a("p",[a("code",[s._v("users")]),s._v(' 为要插入的"表"')]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/oddfar/static/img/MongoDB/mongo-x-usage-3.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#向集合中添加一个文档")]),s._v("\ndb.inventory.insertOne"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"canvas"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(", tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cotton"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.5")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#向集合中添加多个文档")]),s._v("\ndb.inventory.insertMany"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"journal"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(", tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"blank"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"red"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mat"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("85")]),s._v(", tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gray"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27.9")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.5")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mousepad"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(", tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gel"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"blue"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22.85")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("注：当我们向 "),a("code",[s._v("inventory")]),s._v(" 中插入 "),a("code",[s._v("document")]),s._v(" 文档时, 如果没有给文档指定 "),a("code",[s._v("_id")]),s._v(" 属性, 那么数据库会为文档自动添加 "),a("code",[s._v("_id")]),s._v(" field, 并且值类型是 "),a("code",[s._v("ObjectId(blablabla)")]),s._v(", 就是文档的唯一标识, 类似于 relational database 里的 "),a("code",[s._v("primary key")])]),s._v(" "),a("p",[s._v("这个数据库工具叫 "),a("strong",[s._v("Navicat")])]),s._v(" "),a("blockquote",[a("p",[s._v("“Navicat”是一套可创建多个连接的数据库管理工具，用以方便管理 MySQL、Oracle、PostgreSQL、SQLite、SQL Server、MariaDB 和/或 MongoDB 等不同类型的数据库，并支持管理某些云数据库，例如阿里云、‎腾讯云。")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/oddfar/static/img/MongoDB/image-20210915173925342.png",alt:"image-20210915173925342"}})]),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("mongo 中的数字, 默认情况下是 double 类型, 如果要存整型, 必须使用函数 "),a("code",[s._v("NumberInt(整型数字)")]),s._v(", 否则取出来就有问题了")]),s._v(" "),a("li",[s._v("插入当前日期可以使用 "),a("code",[s._v("new Date()")])])])]),s._v(" "),a("p",[s._v("如果某条数据插入失败, 将会终止插入, 但已经插入成功的数据"),a("strong",[s._v("不会回滚掉")]),s._v(". 因为批量插入由于数据较多容易出现失败, 因此, 可以使用 "),a("code",[s._v("try catch")]),s._v(" 进行异常捕捉处理, 测试的时候可以不处理.如：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("try "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  db.comment.insertMany"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"articleid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100001"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"content"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"我们不应该把清晨浪费在手机上, 健康很重要, 一杯温水幸福你我 他."')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1002"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"相忘于江湖"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"createdatetime"')]),s._v(":new Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2019-0805T22:08:15.522Z"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"likenum"')]),s._v(":NumberInt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"articleid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100001"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"content"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"我夏天空腹喝凉开水, 冬天喝温开水"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1005"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"伊人憔 悴"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"createdatetime"')]),s._v(":new Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2019-08-05T23:58:51.485Z"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"likenum"')]),s._v(":NumberInt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("888")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"articleid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100001"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"content"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"我一直喝凉开水, 冬天夏天都喝."')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1004"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"杰克船 长"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"createdatetime"')]),s._v(":new Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2019-08-06T01:05:06.321Z"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"likenum"')]),s._v(":NumberInt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("666")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"4"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"articleid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100001"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"content"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"专家说不能空腹吃饭, 影响健康."')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1003"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"凯 撒"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"createdatetime"')]),s._v(":new Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2019-08-06T08:18:35.288Z"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"likenum"')]),s._v(":NumberInt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"articleid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100001"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"content"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"研究表明, 刚烧开的水千万不能喝, 因为烫 嘴."')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1003"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"凯撒"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"createdatetime"')]),s._v(":new Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2019-0806T11:01:02.521Z"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"likenum"')]),s._v(":NumberInt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" catch "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  print "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询"}},[s._v("#")]),s._v(" 查询")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/oddfar/static/img/MongoDB/mongo-x-usage-4.png",alt:"img"}})]),s._v(" "),a("ul",[a("li",[s._v("使用 "),a("code",[s._v("db.<collection_name>.find()")]),s._v(" 方法对集合进行查询, 接受一个 json 格式的查询条件. 返回的是一个"),a("strong",[s._v("数组")])]),s._v(" "),a("li",[a("code",[s._v("db.<collection_name>.findOne()")]),s._v(" 查询集合中符合条件的第一个文档, 返回的是一个"),a("strong",[s._v("对象")])])]),s._v(" "),a("p",[s._v("查询全部数据：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("db.inventory.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("数据准备：")])]),s._v(" "),a("p",[s._v("先删除之前的数据：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("db.comment.deleteMany"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("我们先往 comment 插入一些数据：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("db.comment.insertMany"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"journal"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"notebook"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.5")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"in"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"paper"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.5")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"in"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"planner"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22.85")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postcard"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15.25")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ul",[a("li",[s._v("可以使用 "),a("code",[s._v("$in")]),s._v(" 操作符表示：查看状态是 A 和 D 的")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("db.comment.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" status: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$in")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("多个查询条件用逗号分隔, 表示 "),a("code",[s._v("AND")]),s._v(" 的关系")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.comment.find( { status: "A", qty: { $lt: 30 } } )\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("等价于sql : "),a("code",[s._v('SELECT * FROM comment WHERE status = "A" AND qty < 30')])]),s._v(" "),a("ul",[a("li",[s._v("使用 "),a("code",[s._v("$or")]),s._v(" 操作符表示后边数组中的条件是OR的关系")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("db.comment.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$or")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" qty: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lt")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("等价于sql : "),a("code",[s._v('SELECT * FROM inventory WHERE status = "A" OR qty < 30')])]),s._v(" "),a("ul",[a("li",[s._v("可以使用 "),a("code",[s._v("pretty()")]),s._v(" 来帮助阅读")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("db.comment.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".pretty"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("创建索引")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("db.posts.createIndex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" title "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'text'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n// 文本搜索\n// will "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" document with title "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Post One"')]),s._v("\n// "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" there is no "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" posts created\ndb.posts.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$text")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$search")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("Post O"),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v('"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".pretty"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更新"}},[s._v("#")]),s._v(" 更新")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/oddfar/static/img/MongoDB/mongo-x-usage-5.png",alt:"img"}})]),s._v(" "),a("ul",[a("li",[s._v("使用 "),a("code",[s._v("db.<collection_name>.updateOne(<filter>, <update>, <options>)")]),s._v(" 方法修改一个匹配 "),a("code",[s._v("<filter>")]),s._v(" 条件的文档")]),s._v(" "),a("li",[s._v("使用 "),a("code",[s._v("db.<collection_name>.updateMany(<filter>, <update>, <options>)")]),s._v(" 方法修改所有匹配 "),a("code",[s._v("<filter>")]),s._v(" 条件的文档")]),s._v(" "),a("li",[s._v("使用 "),a("code",[s._v("db.<collection_name>.replaceOne(<filter>, <update>, <options>)")]),s._v(" 方法"),a("strong",[s._v("替换")]),s._v("一个匹配 "),a("code",[s._v("<filter>")]),s._v(" 条件的文档")]),s._v(" "),a("li",[a("code",[s._v("db.<collection_name>.update(查询对象, 新对象)")]),s._v(" 默认情况下会使用新对象替换旧对象")])]),s._v(" "),a("p",[s._v("其中 "),a("code",[s._v("<filter>")]),s._v(" 参数与查询方法中的条件参数用法一致.")]),s._v(" "),a("p",[s._v("如果需要修改指定的属性, 而不是替换需要用“修改操作符”来进行修改")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("$set")]),s._v(" 修改文档中的制定属性")])]),s._v(" "),a("p",[s._v("其中最常用的修改操作符即为"),a("code",[s._v("$set")]),s._v("和"),a("code",[s._v("$unset")]),s._v(",分别表示"),a("strong",[s._v("赋值")]),s._v("和"),a("strong",[s._v("取消赋值")]),s._v(".")]),s._v(" "),a("p",[s._v("先加入一些数据：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("db.inventory.insertMany"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"canvas"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.5")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"journal"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mat"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("85")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27.9")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.5")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mousepad"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22.85")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"P"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"notebook"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.5")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"in"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"P"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"paper"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.5")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"in"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"planner"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22.85")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postcard"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15.25")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sketchbook"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sketch pad"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("95")]),s._v(", size: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22.85")]),s._v(", w: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30.5")]),s._v(", uom: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("更新数据：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("db.inventory.updateOne"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"paper"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$set")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"size.uom"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"P"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$currentDate")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" lastModified: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\ndb.inventory.updateMany"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" qty: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lt")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$set")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"size.uom"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"in"')]),s._v(", status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"P"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$currentDate")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" lastModified: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[a("code",[s._v("db.<collection_name>.replaceOne()")]),s._v(" 方法替换除 "),a("code",[s._v("_id")]),s._v(" 属性外的"),a("strong",[s._v("所有属性")]),s._v(", 其"),a("code",[s._v("<update>")]),s._v("参数应为一个"),a("strong",[s._v("全新的文档")]),s._v(".")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("db.inventory.replaceOne"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"paper"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"paper"')]),s._v(", instock: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" warehouse: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"B"')]),s._v(", qty: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("blockquote",[a("p",[s._v('修改前：\n{ item: "paper", qty: 100, size: { h: 8.5, w: 11, uom: "in" }, status: "D" }')]),s._v(" "),a("p",[s._v('修改完后：\n{  "item" : "paper", "instock" : [ { "warehouse" : "A", "qty" : 60 }, { "warehouse" : "B", "qty" : 40 } ] }')])]),s._v(" "),a("p",[a("strong",[s._v("批量修改")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("// 默认会修改第一条\ndb.document.update"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" userid: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"30"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("username: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"guest"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n// 修改所有符合条件的数据\ndb.document.update"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" userid: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"30"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("username: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"guest"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("multi: true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除"}},[s._v("#")]),s._v(" 删除")]),s._v(" "),a("ul",[a("li",[s._v("使用 "),a("code",[s._v("db.collection.deleteMany()")]),s._v(" 方法删除所有匹配的文档.")]),s._v(" "),a("li",[s._v("使用 "),a("code",[s._v("db.collection.deleteOne()")]),s._v(" 方法删除单个匹配的文档.")]),s._v(" "),a("li",[a("code",[s._v("db.collection.drop()")])]),s._v(" "),a("li",[a("code",[s._v("db.dropDatabase()")])])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("db.inventory.deleteMany"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" qty "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("Delete operations "),a("strong",[s._v("do not drop indexes")]),s._v(", even if deleting all documents from a collection.")]),s._v(" "),a("p",[s._v("一般数据库中的数据都不会真正意义上的删除, 会添加一个字段, 用来表示这个数据是否被删除")])]),s._v(" "),a("h2",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[s._v("#")]),s._v(" 参考文章")]),s._v(" "),a("ul",[a("li",[s._v("https://zhenye-na.github.io/2020/01/27/intro-to-mongodb.html")]),s._v(" "),a("li",[s._v("https://www.pdai.tech/md/db/nosql-mongo/mongo-x-usage-1.html")])])],1)}),[],!1,null,null,null);t.default=e.exports}}]);